<div class="contain-to-grid">
  <nav class="top-bar" data-topbar role="navigation">
    <ul class="title-area">
      <li class="name">
        <%= link_to root_path, class: "home-button" do %>
          <img src=<%= asset_path "assets/storeluv-logo.png" %>>
        <% end %>
      </li>
       <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
      <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
    </ul>
    <section class="top-bar-section">
      <ul class="right">
        <li id="sign-in-li" ng-show="!user.id">
          <a data-reveal-id="signInModal">Sign in</a>
        </li>

        <div id="signInModal" class="reveal-modal" ng-controller="UserSessionsController" data-reveal>
          <h2>Sign in to your StoreLuv account</h2>
          <p>Need to register for an account? <a data-reveal-id="signUpModal">Sign up now!</a></p>
            
          
          <div class="alert alert-danger" role="alert" ng-show="error">
            {{error}} 
          </div>

          <form ng-submit="submitLogin(loginForm)" role="form" ng-init="loginForm = {}">
            <div class="form-group"> 
              <label for="email">Email</label> 
              <input type="email" name="email" id="email" ng-model="loginForm.email" required="required" class="form-control"> 
            </div> 
            <div class="form-group"> 
              <label for="password">Password</label> 
              <input type="password" name="password" id="password" ng-model="loginForm.password" required="required" class="form-control"> 
            </div> 
            <button type="submit" class="btn btn-primary btn-lg">Sign in</button> 
          </form>
          <a class="close-reveal-modal">&#215;</a>
        </div>

        <div id="signUpModal" class="reveal-modal" ng-controller="UserRegistrationsController" data-reveal>
          <h2>Sign Up For a StoreLuv account</h2>
          <p>Already got an account? <a data-reveal-id="signInModal">Sign in now!</a></p>
          <div class="alert alert-danger" role="alert" ng-show="error">
            {{error}} 
          </div>
          <form ng-submit="submitRegistration(registrationForm)" role="form" ng-init="registrationForm = {}">
            <div class="form-group">
              <label>Email</label>
              <input type="email" name="email" ng-model="registrationForm.email" required="required" class="form-control"/>
            </div>

            <div class="form-group">
              <label>Password</label>
              <input type="password" name="password" ng-model="registrationForm.password" required="required" class="form-control"/>
            </div>

            <div class="form-group">
              <label>Password confirmation</label>
              <input type="password" name="password_confirmation" ng-model="registrationForm.password_confirmation" required="required" class="form-control"/>
            </div>

            <button type="submit" class="btn btn-primary btn-lg">Register</button>
          </form>
          <a class="close-reveal-modal">&#215;</a>
        </div>

        <li id="sign-out-li" ng-show="user.id"><a ng-click='signOut()'>Sign out</a></li>


      </ul>
    </section>
  </nav>
</div>

<div class="feature-hero">
  <div class="feature-transparency">
    <div class="row">
      <div class="feature-copy-card">
        <h1 class="feature-title"><%= @feature.title %></h1> 
        <h4 class="feature-copy"><%= @feature.copy %></h4>
        <% if @feature.feature_links.any? %>
        <ul class="no-bullet">
          <% @feature.feature_links.first(4).each do |fl| %>
            <li>
              <h5><%= link_to fl.name.titleize + " >", fl.link_url %></h5>
            </li>
          <% end %>
        </ul>
      <% end %>
      </div>
      
    </div>
  </div>
</div>



<div class="row products-row">
<ul class="small-block-grid-1 medium-block-grid-2 large-block-grid-4" >
<% @products.each do |product| %>
  <li>
    <div class="product-container">
      <div class="feature-product-image-container">
        <%= image_tag product.image_url, class: "feature-product-image", alt: "#{product.name} by #{product.brand.name}" %>
      </div>
      
      <%= link_to "Buy", buy_product_path(product), target: "_blank", class: "button buy-button" %>
      <a data-reveal-id="modal<%= product.id %>" class="button feature-info-button">Info</a>

      <div id="modal<%= product.id %>" class="reveal-modal medium" data-reveal>
        <%= link_to buy_product_path(product), target: "_blank" do %>
          <h2><%= product.name.titleize %></h2>
        <% end %>
        <h4>By <%= product.brand.name.titleize %></h4>
        <%= link_to buy_product_path(product), target: "_blank" do %>£<%= number_with_precision(product.display_price, precision: 2) %>
        <% end %>
        <p class="lead"><%= product.description %></p>
         
        <a class="close-reveal-modal">&#215;</a>
      </div>
      <div class="product-description">
        <p class="product-brand"> <%= product.brand.name %> </p>
        <p class="product-name"> <%= product.name %> </p>
        <p class="product-price"> £<%= number_with_precision(product.display_price, precision: 2) %> </p>
      </div>
      
    </div>
</li>
<% end %>
</ul>

</div>

<div class="call-to-action">
  <div class="call-to-action-transparency">
    <div class="call-to-action-card row">
      <h2 class="call-to-action-header">Search millions of products</h2>
      <h3 class="call-to-action-copy">All your favourite brands and stores</h3>
      <form action="/" method="GET">
        <div class="row">
          <div class="large-12 columns">
            <div class="row collapse">
              <div class="small-10 columns">
                <input type="text" name="searchString" placeholder="search for what you've been dreaming of"/>
              </div>
              <div class="small-2 columns">
                <input type="submit" class="button postfix"/> 
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function(){
    $('.buy-button').click(function(){
      if (!$("#sign-in-li").hasClass("ng-hide")) {
        $('#signUpModal').foundation('reveal', 'open');
      }
    });

    $('.home-button').click(function(){
      location.href = location.origin
    });
  });
</script>